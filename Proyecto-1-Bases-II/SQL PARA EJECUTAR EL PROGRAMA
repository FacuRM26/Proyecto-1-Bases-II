DROP TABLE Personaje_Juego;
DROP TABLE Raza_Juego;
DROP TABLE Juego;
DROP TABLE Personaje;    
DROP TABLE Raza;  


create table Raza(
       id  number generated always  as identity primary key,
       nombre varchar2(50),
       habitat varchar2(50),
       Etimologia varchar2(500)  
);
    

create table Personaje(
    id  number generated always  as identity primary key,
    nombre varchar2(100),
    genero varchar2(20),
    Ciudad_residencia varchar2(50),
    Familia varchar2(50),
    enemigo number(1,0),
    raza_id number,
    FOREIGN KEY (raza_id)
    REFERENCES raza(id)
);

create table Juego(
    id  number generated always  as identity primary key,
    nombre varchar2(100),
    Consolas varchar2(200),
    fecha_Publicacion date,
    linea_cronologica varchar2(50)
);

create table Personaje_Juego(
    personaje_id number,
    juego_id number,
   
    FOREIGN KEY (personaje_id)
    REFERENCES personaje(id),
  
    FOREIGN KEY (juego_id)
    REFERENCES juego(id)
);

create table Raza_Juego(
    raza_id number,
    juego_id number,
    
    FOREIGN KEY (raza_id)
    REFERENCES raza(id),
 
    FOREIGN KEY (juego_id)
    REFERENCES juego(id)
);

  





create or replace NONEDITIONABLE TRIGGER TRG_FECHA_PERSONAJE 
BEFORE INSERT ON PERSONAJE FOR EACH ROW
BEGIN
   :NEW.FECHA_REGISTRO := SYSDATE;
END;

create or replace NONEDITIONABLE Procedure Pr_Consulta_Personajes_X_Juego (P_Juego Number, C_Personajes Out Sys_Refcursor) As 
Begin

    Open C_Personajes For Select A.personaje_id, b.nombre From PERSONAJE_JUEGO A, PERSONAJE B
    Where  a.personaje_id =  b.id
    AND A.juego_id= P_Juego;
End Pr_Consulta_Personajes_X_Juego;


INSERT INTO Raza(NOMBRE, HABITAT, ETIMOLOGIA) VALUES ('Minish', 'Bosque Minish', 'La palabra "minish" es una palabra arcaica que significa disminuir o atenuar');
INSERT INTO Raza(NOMBRE, HABITAT, ETIMOLOGIA) VALUES ('Goron', 'Hyrule', 'El nombre Goron procede de la onomatopeya japonesa Goro goro, usada para expresar el sonido de una roca rodando, lo que hace referencia a la forma deLos Goron de rodar como una roca y a sus propiedades de roca.');
INSERT INTO Raza(NOMBRE, HABITAT, ETIMOLOGIA) VALUES ('Hyliano','Hyrule','deriva del nombre de su deidad protectora');


INSERT INTO Juego(NOMBRE, CONSOLAS, FECHA_PUBLICACION, LINEA_CRONOLOGICA) VALUES ('The Legend of Zelda: Majora''s Mask', 'Nintendo 64,Nintndo 3ds', TO_DATE('2000-04-27 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Heroe Triunfante');
INSERT INTO Juego(NOMBRE, CONSOLAS, FECHA_PUBLICACION, LINEA_CRONOLOGICA) VALUES ('The Legend of Zelda: The Minish Cap', 'GBA,Nintendo 3DS', TO_DATE('2004-09-04 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Linea Principal');
INSERT INTO Juego(NOMBRE, CONSOLAS, FECHA_PUBLICACION, LINEA_CRONOLOGICA) VALUES ('The Legend of Zelda: A Link Between Worlds', 'Nintendo 3DS', TO_DATE('2013-10-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Fracaso del Heroe');
INSERT INTO Juego(NOMBRE, CONSOLAS, FECHA_PUBLICACION, LINEA_CRONOLOGICA) VALUES ('The legend of Zelda: Ocarina Of time','Nintendo 64,Nintndo 3ds',TO_DATE('21/11/1998','DD/MM/YYYY'),'linea principal');

INSERT INTO Personaje(NOMBRE, GENERO, CIUDAD_RESIDENCIA, FAMILIA, ENEMIGO, RAZA_ID) VALUES ('Daruk', 'Masculino', 'Ciudad Goron', 'Yunobo', '0', 1);
INSERT INTO Personaje(NOMBRE, GENERO, CIUDAD_RESIDENCIA, FAMILIA, ENEMIGO, RAZA_ID) VALUES ('Princesa Ruto', 'Femenino', 'Lago Hylia', 'Rey Zoro XVI', '0', 2);
INSERT INTO Personaje(NOMBRE, GENERO, CIUDAD_RESIDENCIA, FAMILIA, ENEMIGO, RAZA_ID) VALUES ('Ezero', 'Masculino', 'Mundo Minish', 'Desconocido', '0', 1);
INSERT INTO Personaje(NOMBRE, GENERO, CIUDAD_RESIDENCIA, FAMILIA, ENEMIGO, RAZA_ID) VALUES ('Link','Masculino','Hyrule','Smith',0,3);



-- SELECTS

select * from personaje;
select * from raza;
select * from juego;
select * from personaje_juego;
select * from raza_juego;
commit;
  
